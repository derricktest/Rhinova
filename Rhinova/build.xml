<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="run" name="Create Runnable Jar for Project Rhinova with libraries in sub-folder">
	
	<!-- PROPERTIES USED IN THE BUILD -->
	
	<!-- FOLDER PROPERTIES -->
	<property name="release.dir" 		value="release"/>
	<property name="jar.name" 			value="rhinova.jar"/>
	<property name="jar.path" 			value="${release.dir}/${jar.name}"/>
	<property name="classes.dir" 		value="bin"/>
	<property name="lib.path" 			value="${release.dir}/rhinova_lib"/>
	<property name="spring.xml.file" 	value="Spring.xml"/>
	<property name="docs.dir" 			value="doc" />
	<property name="code.src" 			value="src"/>
	<property name="src.dir" 			value="${code.src}; test;" />
		
	<!-- CLASS PATH OF APPLICATION -->
    <path id="classpath">
        <fileset dir="${lib.path}" includes="*.*"/>
    </path>	
	
	<!-- JUNIT PROPERTIES -->
	<property name="test.dir" location="test" />
	<property name="test.report.dir" location="testreport" />
	
	  <path id="junit.class.path">
	    <pathelement location="${jar.path}" />
	  	<pathelement location="${classes.dir}"/>
	  </path>

	
	<!-- CLEANING BINDARY FOLDERS -->
	<target name="clean">
		<mkdir dir="bin"/>
		<delete dir="bin"/>
		<mkdir dir="${test.report.dir}"/>
	</target>
		
	
	<!-- COPYING NEEDED FILES TO THE BINARY DIRECTORY FOR JARING -->
    <target name="copy">
		<!-- SPRING CONFIGURATION FILE -->
		<copy file="src/${spring.xml.file}" todir="${classes.dir}"/>
    	<copy todir="${classes.dir}">
    		<fileset dir="src">
    			<exclude name="**/*.java"/>
    		</fileset>
    	</copy>
    </target>

		
	<!-- COMPILING THE JAVA SOURCE CODE -->
    <target name="compile" depends="clean,copy">
        <mkdir dir="${classes.dir}"/>
        <javac srcdir="${src.dir}" destdir="${classes.dir}" classpathref="classpath">
    	</javac>
    </target>
	
	
	<!-- RUNNING UNIT TESTS -->
	  <target name="junit" depends="compile">
	    <junit printsummary="on" fork="true" haltonfailure="yes">
	      <classpath refid="junit.class.path" />
	      <formatter type="xml" />
	      <batchtest todir="${test.report.dir}">
	        <fileset dir="${test.dir}">
	          <include name="**/*Test*.java" />
	        </fileset>
	      </batchtest>
	    </junit>
	  </target>
	
	  <!-- CREATING JAVADOC -->
	  <target name="docs" depends="compile">
	    <javadoc packagenames="src" sourcepath="${code.src}" destdir="${docs.dir}">
	       <fileset dir="${code.src}">
	                <include name="**/*.java" />
	           </fileset>
	    </javadoc>
	  </target>
	
	<!-- PACKAGING THE JAVA SOURCE CODE INTO A JAR -->
    <target name="jar" depends="compile">
    	<delete file="${jar.path}"/>
        <jar destfile="${jar.path}">
            <manifest>
                <attribute name="Main-Class" value="rhinova.RhinovaLauncher"/>
            	<attribute name="Class-Path" value=". rhinova_lib/aopalliance-1.0.jar rhinova_lib/appframework-1.0.3.jar rhinova_lib/asm-3.3.1.jar rhinova_lib/aspectjweaver-1.7.3.jar rhinova_lib/beansbinding-1.2.1.jar rhinova_lib/cglib-2.2.3.jar rhinova_lib/cglib-nodep-2.2.3.jar rhinova_lib/commons-logging-1.1.3.jar rhinova_lib/commons-math3-3.2.jar rhinova_lib/GLPKSolverPack.jar rhinova_lib/hamcrest-core-1.3.jar rhinova_lib/itext-2.0.1.jar rhinova_lib/jcommon-1.0.21.jar rhinova_lib/jfreechart-1.0.17-experimental.jar rhinova_lib/jfreechart-1.0.17-swt.jar rhinova_lib/jfreechart-1.0.17.jar rhinova_lib/jfreesvg-1.4.jar rhinova_lib/jgoodies-forms-1.7.1.jar rhinova_lib/jgoodies-uif-lite-javadoc.zip rhinova_lib/jgoodies-uif-lite-src.zip rhinova_lib/jgoodies-uif-lite.jar rhinova_lib/junit.jar rhinova_lib/LPSOLVESolverPack.jar rhinova_lib/miglayout-3.5.5-ideutil-java14.jar rhinova_lib/miglayout-3.5.5-ideutil.jar rhinova_lib/miglayout-3.5.5-swing-java14.jar rhinova_lib/miglayout-3.5.5-swing.jar rhinova_lib/miglayout-3.5.5-swt-java14.jar rhinova_lib/miglayout-3.5.5-swt.jar rhinova_lib/miglayout-3.5.5.jar rhinova_lib/opencsv-2.3.jar rhinova_lib/org.hamcrest.core_1.3.0.v201303031735.jar rhinova_lib/orsoncharts-1.0-eval.jar rhinova_lib/orsonpdf-1.3-eval.jar rhinova_lib/ScpMain.jar rhinova_lib/SCPSolver.jar rhinova_lib/servlet.jar rhinova_lib/spring-aop-4.0.0.M2.jar rhinova_lib/spring-aspects-4.0.0.M2.jar rhinova_lib/spring-beans-4.0.0.M2.jar rhinova_lib/spring-context-4.0.0.M2-javadoc.jar rhinova_lib/spring-context-4.0.0.M2.jar rhinova_lib/spring-context-support-4.0.0.M2.jar rhinova_lib/spring-core-4.0.0.M2-sources.jar rhinova_lib/spring-core-4.0.0.M2.jar rhinova_lib/spring-expression-4.0.0.M2.jar rhinova_lib/spring-instrument-4.0.0.M2.jar rhinova_lib/spring-instrument-tomcat-4.0.0.M2.jar rhinova_lib/spring-jdbc-4.0.0.M2.jar rhinova_lib/spring-jms-4.0.0.M2.jar rhinova_lib/spring-messaging-4.0.0.M2.jar rhinova_lib/spring-orm-4.0.0.M2.jar rhinova_lib/spring-oxm-4.0.0.M2.jar rhinova_lib/spring-test-4.0.0.M2.jar rhinova_lib/spring-tx-4.0.0.M2-javadoc.jar rhinova_lib/spring-tx-4.0.0.M2.jar rhinova_lib/spring-web-4.0.0.M2.jar rhinova_lib/spring-webmvc-4.0.0.M2.jar rhinova_lib/spring-webmvc-portlet-4.0.0.M2.jar rhinova_lib/spring-websocket-4.0.0.M2.jar rhinova_lib/swing-layout-javadoc.zip rhinova_lib/swing-layout-src.zip rhinova_lib/swing-layout.jar rhinova_lib/swing-worker-1.1.jar rhinova_lib/swtgraphics2d.jar"/>
            </manifest>
        	<fileset dir="${classes.dir}"/>
        </jar>
    </target>
	
	<!-- RUNNING THE APPLCIATION -->
    <target name="run" depends="compile">
        <java jar="${jar.path}" fork="true"/>
    </target>
	
	
	<target name="all" depends="run,docs,junit"/>
	
	
	
	</project>
